<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>cadmus documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">cadmus documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>LibraryRouteService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>libs/core/src/lib/services/library-route.service.ts</code>
        </p>

            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Library route service.
This service is used to build routes to part and fragment editors,
which are hosted in an open list of library modules in the Cadmus
application.
This architecture allows lazy-loading part- and fragment-editors
only when they are required.
Each part type with its dumb UI editor component is located in a
library, named after the name of the group the part belongs to. For
instance, the model and dumb UI editor component for a part belonging
to the &quot;general&quot; group are located in the &quot;parts/general/general-ui&quot;
library.
In turn, the feature UI editor component for the same part is located
in the &quot;parts/general/general-feature&quot; library. This library has
a route for each part editor. For instance, the NotePart editor
component route is &quot;items/:iid/general/net.fusisoft.note/:pid&quot;, where
&quot;:iid&quot; is the item ID and &quot;:pid&quot; the part ID.</p>

            </p>



            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#buildFragmentEditorRoute">buildFragmentEditorRoute</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#buildPartEditorRoute">buildPartEditorRoute</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#decomposeEditorKey">decomposeEditorKey</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#findPartDefinition">findPartDefinition</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getEditorKeyFromPartType">getEditorKeyFromPartType</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getFragmentTypeAndRole">getFragmentTypeAndRole</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#stripFragmentRoleId">stripFragmentRoleId</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(_partEditorKeys: <a href="../interfaces/PartEditorKeys.html">PartEditorKeys</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:25</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>_partEditorKeys</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/PartEditorKeys.html" target="_self" >PartEditorKeys</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="buildFragmentEditorRoute"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            buildFragmentEditorRoute
                        </b>
                        <a href="#buildFragmentEditorRoute"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>buildFragmentEditorRoute(partDefs: PartDefinition[], itemId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, partId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, typeId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, roleId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, loc: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="213"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:213</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Build the route to the fragment editor corresponding to the specified
layers part and location.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>partDefs</td>
                                    <td>
                                            <code>PartDefinition[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The parts definitions.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>itemId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The ID of the item the parts belongs to.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>partId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The part&#39;s ID.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>typeId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The part&#39;s type ID.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>roleId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The part&#39;s role ID.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>loc</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The fragment&#39;s location.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>literal type</code>

                    </div>
                    <div class="io-description">
                        <p>Object with a route property and an optional rid property
representing the role ID, which will be rendered as a query parameter.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="buildPartEditorRoute"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            buildPartEditorRoute
                        </b>
                        <a href="#buildPartEditorRoute"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>buildPartEditorRoute(partDefs: PartDefinition[], itemId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, partId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, typeId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="186"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:186</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Build the route to the part editor corresponding to the specified
part.</p>
<p>A part editing route is like
&quot;/items/<id>/<part-group>/<part-typeid>/<part-id>?rid=<role-id>&quot;,
where the role ID is optional, and may include the fragment role ID
as a suffix preceded by a colon.</p>
<p>A fragment editing route is like
&quot;/items/<id>/<part-group>/fragment/<part-id>/<fr-typeid>/<loc>?rid=<role-id>&quot;,
where the role ID is as above, and the fragment&#39;s type ID is derived
from the part&#39;s role ID, stripping the eventual fragment&#39;s role ID out.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>partDefs</td>
                                    <td>
                                            <code>PartDefinition[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The parts definitions.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>itemId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The ID of the item the parts belongs to.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>partId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The part&#39;s ID.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>typeId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The part&#39;s type ID.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        <p>Object with a route property and an optional rid property
representing the role ID, which will be rendered as a query parameter.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="decomposeEditorKey"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            decomposeEditorKey
                        </b>
                        <a href="#decomposeEditorKey"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>decomposeEditorKey(key: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="150"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:150</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Decompose the specified editor key into part and fragment.
A simple editor key will just provide the same value for both.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>key</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The editor key to decompose.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>literal type</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findPartDefinition"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            findPartDefinition
                        </b>
                        <a href="#findPartDefinition"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findPartDefinition(partDefs: PartDefinition[], typeId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, roleId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="87"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:87</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Find among the specified parts definitions the one matching the specified
type ID, and eventually role ID when specified.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>partDefs</td>
                                    <td>
                                            <code>PartDefinition[]</code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                    </td>

                                    <td>
                                        <p>The parts definitions.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>typeId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                    </td>

                                    <td>
                                        <p>The type ID.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>roleId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>null</code>
                                    </td>

                                    <td>
                                        <p>The role ID or null.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>PartDefinition | null</code>

                    </div>
                    <div class="io-description">
                        <p>Part definition or null if not found.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getEditorKeyFromPartType"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            getEditorKeyFromPartType
                        </b>
                        <a href="#getEditorKeyFromPartType"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getEditorKeyFromPartType(typeId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, roleId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="119"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:119</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Get the library editor key from the specified part type, looking up
the specified parts definitions.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>typeId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                    </td>

                                    <td>
                                        <p>The part&#39;s type ID.</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>roleId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>null</code>
                                    </td>

                                    <td>
                                        <p>The part&#39;s role ID.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>literal type</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getFragmentTypeAndRole"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            getFragmentTypeAndRole
                        </b>
                        <a href="#getFragmentTypeAndRole"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getFragmentTypeAndRole(roleId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="58"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:58</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Get the fragment type and role from the part&#39;s role ID. This starts
with &quot;fr.&quot;, and might be followed by the role proper, introduced
by the first dot if any. For instance, &quot;fr.net.fusisoft.comment&quot; would just
return &quot;fr.net.fusisoft.comment&quot;, while &quot;fr.net.fusisoft.comment:scholarly&quot;
would return &quot;fr.net.fusisoft.comment&quot;. This is required to navigate to
the correct fragment editor, which is the same for each fragment type,
independently from its role.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>roleId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>literal type</code>

                    </div>
                    <div class="io-description">
                        <p>An object where frTypeId=fragment type ID and frRoleId=fragment role
ID, or null.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stripFragmentRoleId"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            stripFragmentRoleId
                        </b>
                        <a href="#stripFragmentRoleId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>stripFragmentRoleId(roleId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="37"
                            class="link-to-prism">libs/core/src/lib/services/library-route.service.ts:37</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Strip the eventual fragment-role ID from the specified part&#39;s role ID.
For instance, a part&#39;s role ID like &quot;fr.net.fusisoft.comment:scholarly&quot;
becomes &quot;fr.net.fusisoft.comment&quot;.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>roleId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The part&#39;s role ID.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, Inject } from &#x27;@angular/core&#x27;;
import { PartDefinition, PartEditorKeys } from &#x27;../models&#x27;;

/**
 * Library route service.
 * This service is used to build routes to part and fragment editors,
 * which are hosted in an open list of library modules in the Cadmus
 * application.
 * This architecture allows lazy-loading part- and fragment-editors
 * only when they are required.
 * Each part type with its dumb UI editor component is located in a
 * library, named after the name of the group the part belongs to. For
 * instance, the model and dumb UI editor component for a part belonging
 * to the &quot;general&quot; group are located in the &quot;parts/general/general-ui&quot;
 * library.
 * In turn, the feature UI editor component for the same part is located
 * in the &quot;parts/general/general-feature&quot; library. This library has
 * a route for each part editor. For instance, the NotePart editor
 * component route is &quot;items/:iid/general/net.fusisoft.note/:pid&quot;, where
 * &quot;:iid&quot; is the item ID and &quot;:pid&quot; the part ID.
 */
@Injectable({
  providedIn: &#x27;root&#x27;
})
export class LibraryRouteService {
  constructor(
    @Inject(&#x27;partEditorKeys&#x27;) private _partEditorKeys: PartEditorKeys
  ) {}

  /**
   * Strip the eventual fragment-role ID from the specified part&#x27;s role ID.
   * For instance, a part&#x27;s role ID like &quot;fr.net.fusisoft.comment:scholarly&quot;
   * becomes &quot;fr.net.fusisoft.comment&quot;.
   *
   * @param roleId The part&#x27;s role ID.
   */
  public stripFragmentRoleId(roleId: string): string {
    // remove the optional :fr-role from roleId
    const i &#x3D; roleId.lastIndexOf(&#x27;:&#x27;);
    if (i &gt; -1) {
      roleId &#x3D; roleId.substring(0, i);
    }
    return roleId;
  }

  /**
   * Get the fragment type and role from the part&#x27;s role ID. This starts
   * with &quot;fr.&quot;, and might be followed by the role proper, introduced
   * by the first dot if any. For instance, &quot;fr.net.fusisoft.comment&quot; would just
   * return &quot;fr.net.fusisoft.comment&quot;, while &quot;fr.net.fusisoft.comment:scholarly&quot;
   * would return &quot;fr.net.fusisoft.comment&quot;. This is required to navigate to
   * the correct fragment editor, which is the same for each fragment type,
   * independently from its role.
   * @param role The part role ID.
   * @returns An object where frTypeId&#x3D;fragment type ID and frRoleId&#x3D;fragment role
   * ID, or null.
   */
  public getFragmentTypeAndRole(
    roleId: string
  ): { frTypeId: string; frRoleId: string | null } {
    if (!roleId || !roleId.startsWith(&#x27;fr.&#x27;)) {
      return null;
    }
    const i &#x3D; roleId.indexOf(&#x27;:&#x27;);
    if (i &gt; -1) {
      return {
        frTypeId: roleId.substring(0, i),
        frRoleId: roleId.substring(i + 1)
      };
    } else {
      return {
        frTypeId: roleId,
        frRoleId: null
      };
    }
  }

  /**
   * Find among the specified parts definitions the one matching the specified
   * type ID, and eventually role ID when specified.
   *
   * @param partDefs The parts definitions.
   * @param typeId The type ID.
   * @param roleId The role ID or null.
   * @returns Part definition or null if not found.
   */
  private findPartDefinition(
    partDefs: PartDefinition[],
    typeId: string,
    roleId: string &#x3D; null
  ): PartDefinition | null {
    if (!partDefs) {
      return null;
    }

    // if role ID is specified, find both type and role
    if (roleId) {
      const reqRoleId &#x3D; this.stripFragmentRoleId(roleId);
      return partDefs.find(d &#x3D;&gt; {
        return (
          d.typeId &#x3D;&#x3D;&#x3D; typeId &amp;&amp;
          this.stripFragmentRoleId(d.roleId) &#x3D;&#x3D;&#x3D; reqRoleId
        );
      });
    }
    // else just find type ID
    return partDefs.find(d &#x3D;&gt; {
      return d.typeId &#x3D;&#x3D;&#x3D; typeId;
    });
  }

  /**
   * Get the library editor key from the specified part type, looking up
   * the specified parts definitions.
   *
   * @param typeId The part&#x27;s type ID.
   * @param roleId The part&#x27;s role ID.
   */
  public getEditorKeyFromPartType(
    typeId: string,
    roleId: string &#x3D; null
  ): { partKey: string; frKey?: string } {
    // find the part type ID
    const partGroupKey &#x3D; this._partEditorKeys[typeId];
    if (!partGroupKey) {
      return {
        partKey: &#x27;default&#x27;
      };
    }

    // additionally find the role ID if specified
    if (roleId) {
      const reqRoleId &#x3D; this.stripFragmentRoleId(roleId);
      return {
        partKey: partGroupKey.part,
        frKey: partGroupKey.fragments[reqRoleId]
      };
    }
    return {
      partKey: partGroupKey.part
    };
  }

  /**
   * Decompose the specified editor key into part and fragment.
   * A simple editor key will just provide the same value for both.
   *
   * @param key The editor key to decompose.
   */
  public decomposeEditorKey(key: string): { partKey: string; frKey: string } {
    const i &#x3D; key.indexOf(&#x27; &#x27;);
    if (i &gt; -1) {
      return {
        partKey: key.substr(0, i),
        frKey: key.substr(i + 1)
      };
    } else {
      return {
        partKey: key,
        frKey: key
      };
    }
  }

  /**
   * Build the route to the part editor corresponding to the specified
   * part.
   *
   * A part editing route is like
   * &quot;/items/&lt;id&gt;/&lt;part-group&gt;/&lt;part-typeid&gt;/&lt;part-id&gt;?rid&#x3D;&lt;role-id&gt;&quot;,
   * where the role ID is optional, and may include the fragment role ID
   * as a suffix preceded by a colon.
   *
   * A fragment editing route is like
   * &quot;/items/&lt;id&gt;/&lt;part-group&gt;/fragment/&lt;part-id&gt;/&lt;fr-typeid&gt;/&lt;loc&gt;?rid&#x3D;&lt;role-id&gt;&quot;,
   * where the role ID is as above, and the fragment&#x27;s type ID is derived
   * from the part&#x27;s role ID, stripping the eventual fragment&#x27;s role ID out.
   *
   * @param partDefs The parts definitions.
   * @param itemId The ID of the item the parts belongs to.
   * @param partId The part&#x27;s ID.
   * @param typeId The part&#x27;s type ID.
   * @returns Object with a route property and an optional rid property
   * representing the role ID, which will be rendered as a query parameter.
   */
  public buildPartEditorRoute(
    partDefs: PartDefinition[],
    itemId: string,
    partId: string,
    typeId: string
  ): string {
    let route: string;
    const editorKey &#x3D; this.getEditorKeyFromPartType(typeId);

    // /items/&lt;id&gt;/&lt;part-group&gt;/&lt;part-typeid&gt;/&lt;part-id&gt;?rid&#x3D;&lt;role-id&gt;
    route &#x3D; &#x60;/items/${itemId}/${editorKey.partKey}/${typeId}/${partId}&#x60;;
    return route;
  }

  /**
   * Build the route to the fragment editor corresponding to the specified
   * layers part and location.
   *
   * @param partDefs The parts definitions.
   * @param itemId The ID of the item the parts belongs to.
   * @param partId The part&#x27;s ID.
   * @param typeId The part&#x27;s type ID.
   * @param roleId The part&#x27;s role ID.
   * @param loc The fragment&#x27;s location.
   * @returns Object with a route property and an optional rid property
   * representing the role ID, which will be rendered as a query parameter.
   */
  public buildFragmentEditorRoute(
    partDefs: PartDefinition[],
    itemId: string,
    partId: string,
    typeId: string,
    roleId: string,
    loc: string
  ): { route: string; rid: string | null } {
    let route: string;
    const editorKey &#x3D; this.getEditorKeyFromPartType(typeId, roleId);
    const { frTypeId, frRoleId } &#x3D; this.getFragmentTypeAndRole(roleId);

    route &#x3D; &#x60;/items/${itemId}/${editorKey.frKey}/fragment/${partId}/${frTypeId}/${loc}&#x60;;
    return {
      route: route,
      rid: frRoleId
    };
  }
}
</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'LibraryRouteService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
